<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Asset Camera OCR</title>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
body { margin:0; background:#000; font-family:Arial; }
video { width:100vw; height:100vh; object-fit:cover; }

#scanBox {
  position:fixed;
  top:30%;
  left:10%;
  width:80%;
  height:20%;
  border:3px solid #00ff88;
  box-sizing:border-box;
}

#status {
  position:fixed; top:0; width:100%;
  background:rgba(0,0,0,.7);
  color:#fff; padding:6px 10px;
  font-size:14px;
}

#overlay {
  position:fixed; bottom:0; width:100%;
  background:rgba(0,0,0,.85);
  color:#00ff88; padding:12px;
  font-size:16px; max-height:45%;
  overflow:auto;
}
</style>
</head>

<body>

<div id="status">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‚Ä¶</div>
<video id="video" autoplay playsinline></video>
<div id="scanBox"></div>
<div id="overlay">‡∏ß‡∏≤‡∏á‡∏õ‡πâ‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö</div>

<script>
const video = document.getElementById("video");
const overlay = document.getElementById("overlay");
const status = document.getElementById("status");

let locked = false;

/* ===== ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á ===== */
navigator.mediaDevices.getUserMedia({
  video:{ facingMode:"environment" }
}).then(s=>{
  video.srcObject = s;
  status.innerText = "‡∏Å‡∏•‡πâ‡∏≠‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
});

/* ===== OCR Loop ===== */
setInterval(async () => {
  if (locked || video.videoWidth === 0) return;

  const vw = video.videoWidth;
  const vh = video.videoHeight;

  // üî• crop ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏•‡∏≤‡∏á
  const sx = vw * 0.10;
  const sy = vh * 0.30;
  const sw = vw * 0.80;
  const sh = vh * 0.20;

  const canvas = document.createElement("canvas");
  canvas.width = sw;
  canvas.height = sh;
  const ctx = canvas.getContext("2d");
  ctx.drawImage(video, sx, sy, sw, sh, 0, 0, sw, sh);

  // üî• ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≤‡∏ß‡∏î‡∏≥ + ‡πÄ‡∏û‡∏¥‡πà‡∏° contrast
  const img = ctx.getImageData(0,0,sw,sh);
  for(let i=0;i<img.data.length;i+=4){
    const avg = (img.data[i]+img.data[i+1]+img.data[i+2])/3;
    const v = avg > 1
